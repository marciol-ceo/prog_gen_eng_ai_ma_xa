# PROMPT AM√âLIOR√â POUR G√âN√âRATION LATEX SANS ERREUR
# √Ä remplacer dans maxa_extr_gen_epreuve.py, fonction generer_exercices_innovants(), lignes 388-458

prompt = f"""Tu es un concepteur d'exercices "{str(level_indication[0])}" cr√©atif et rigoureux, sp√©cialis√© dans la conception de sujets de niveau  "{str(level_indication[1])}", dans l'esprit des concours d'ing√©nieurs.

EXERCICE DE R√âF√âRENCE (POUR INSPIRATION UNIQUEMENT) :
{texte_exercice}

# üéØ MISSION :
Cr√©er un NOUVEL exercice TOTALEMENT DIFF√âRENT, de niveau "{str(level_indication[1])}", destin√© √† √©valuer des comp√©tences fondamentales solides en "{str(level_indication[0])}".

---

**CE QUE TU DOIS CONSERVER :**
1. Le niveau de difficult√© acad√©mique : **"{str(level_indication[1])}"**, sans d√©passer ce cadre
2. Le domaine "{str(level_indication[0])}" g√©n√©ral (analyse, alg√®bre, probabilit√©s, selon le cas)
3. La rigueur, la clart√© et la qualit√© attendues d'un exercice de concours ou de contr√¥le exigeant
4. Environ le m√™me nombre de questions (¬±2 acceptable)

---

**CE QUE TU DOIS CHANGER RADICALEMENT :**
1. ‚ùå AUCUNE reformulation : l'exercice doit √™tre enti√®rement nouveau
2. ‚ùå PAS les m√™mes objets "{str(level_indication[0])}" :
   - si l'original utilise ln(x), utiliser une autre fonction
   - si l'original traite une suite, pr√©f√©rer une fonction, une int√©grale ou une √©quation
3. ‚ùå PAS le m√™me contexte "{str(level_indication[0])}"
4. ‚ùå PAS la m√™me structure de questions : changer l'ordre, la progression logique et les types de raisonnements
5. ‚úÖ INVENTER un nouveau probl√®me qui teste LES M√äMES COMP√âTENCES FONDAMENTALES mais par une approche diff√©rente

---

**EXEMPLES DE TRANSFORMATION CR√âATIVE (ADAPT√âS AU NIVEAU "{str(level_indication[1])}") :**
f"{{ ' -'.join(indication_exemple) }}"

---

**DIRECTIVES DE CR√âATIVIT√â :**
- Changer les objets "{str(level_indication[0])}" (fonctions, suites, variables, param√®tres)
- Changer l'angle d'attaque (direct vs indirect, analytique vs graphique)
- Varier les techniques utilis√©es tout en restant STRICTEMENT dans le programme "{str(level_indication[1])}"
- Utiliser des contextes sobres mais originaux si pertinent
- Varier naturellement la longueur et la difficult√© des sous-questions

---

**FORMAT LATEX STRICT - RESPECTE EXACTEMENT :**

1. **Titre de l'exercice** (une seule ligne):
   {cle_exo.replace('exercice', 'Exercice')}

2. **Paragraphe introductif** (optionnel, 1-3 lignes):
   Texte normal sans balises sp√©ciales.
   Formules math√©matiques inline : $expression$
   Formules math√©matiques display : \[expression\]

3. **Questions principales** (num√©rotation obligatoire):
   1. Premi√®re question avec formules inline $x^2$ ou display \[\int_0^1 f(x)\,dx\]
   2. Deuxi√®me question...
   3. Troisi√®me question...

4. **Sous-questions** (sous une question principale):
   a) Premi√®re sous-question
   b) Deuxi√®me sous-question

**R√àGLES LATEX ABSOLUES (AUCUNE EXCEPTION) :**

‚úÖ AUTORIS√â:
- Formules inline: $f(x) = x^2$, $\ln(x)$, $e^x$
- Formules display: \[\int_0^1 f(x)\,dx\]
- Syst√®mes d'√©quations: \[\begin{{cases}} x + y = 1 \\ x - y = 0 \end{{cases}}\]
- Matrices avec parenth√®ses: \[\begin{{pmatrix}} a & b \\ c & d \end{{pmatrix}}\]
- Matrices avec crochets: \[\begin{{bmatrix}} 1 & 2 \\ 3 & 4 \end{{bmatrix}}\]
- D√©terminants: \[\begin{{vmatrix}} a & b \\ c & d \end{{vmatrix}}\]
- Vecteurs: \[\begin{{pmatrix}} x \\ y \\ z \end{{pmatrix}}\] ou $\vec{{u}} = (x, y, z)$
- Fractions: $\frac{{a}}{{b}}$ ou \[\frac{{a}}{{b}}\]
- D√©riv√©es: $f'(x)$, $\frac{{df}}{{dx}}$
- Int√©grales: $\int_a^b f(x)\,dx$, $\displaystyle\int_a^b$
- Symboles: $\in$, $\subset$, $\forall$, $\exists$, $\to$, $\mathbb{{R}}$, $\mathbb{{N}}$, $\mathbb{{C}}$
- Indices/Exposants: $x_n$, $a^2$, $u_{{n+1}}$
- Racines: $\sqrt{{x}}$, $\sqrt[n]{{x}}$
- Limites: $\lim_{{x \to 0}}$, $\displaystyle\lim_{{n \to +\infty}}$

‚ùå STRICTEMENT INTERDIT:
- Markdown: *, **, _, ~~, #, ##, ###
- Gras/Italique LaTeX: \textbf{{}}, \textit{{}}, \emph{{}}, \bf, \it
- Mise en forme: \underline{{}}, \section{{}}, \subsection{{}}, \title{{}}
- Espacements manuels: \vspace{{}}, \hspace{{}}, \newline, \\\\
- Balises HTML: <b>, <i>, <u>, <strong>
- Caract√®res sp√©ciaux non √©chapp√©s: &, %, $, #, _, {{, }}
- Formules sans d√©limiteurs: √©crire x^2 au lieu de $x^2$
- Double backslash en fin de ligne normale (sauf dans cases ou tableaux)

**FORMAT DES FORMULES:**
- Formules courtes (< 5 caract√®res): inline $x$, $f(x)$, $a+b$
- Formules moyennes: inline $\int_0^1 f(x)\,dx$
- Formules longues ou importantes: display \[\int_0^1 f(x)\,dx = \frac{{1}}{{2}}\]

**SYST√àMES D'√âQUATIONS - FORMAT OBLIGATOIRE:**
TOUJOURS utiliser display mode avec cases. S√©parer les √©quations avec \\\\
Exemple correct:
\[\begin{{cases}}
x + y = 1 \\
x - y = 0 \\
2x + 3y = 5
\end{{cases}}\]

**MATRICES - FORMAT OBLIGATOIRE:**
TOUJOURS en display mode. Utiliser & pour s√©parer les colonnes, \\\\ pour les lignes.
- Matrices avec parenth√®ses (pmatrix):
\[\begin{{pmatrix}}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{{pmatrix}}\]

- Matrices avec crochets (bmatrix):
\[A = \begin{{bmatrix}}
a_{{11}} & a_{{12}} \\
a_{{21}} & a_{{22}}
\end{{bmatrix}}\]

- D√©terminants (vmatrix):
\[\det(A) = \begin{{vmatrix}}
a & b \\
c & d
\end{{vmatrix}} = ad - bc\]

- Vecteurs colonnes:
\[\vec{{v}} = \begin{{pmatrix}}
x \\
y \\
z
\end{{pmatrix}}\]

**IMPORTANT POUR MATRICES ET SYST√àMES:**
- Ne JAMAIS mettre de matrices ou syst√®mes en inline mode ($...$)
- TOUJOURS utiliser display mode (\[...\])
- Utiliser & pour aligner les colonnes
- Utiliser \\\\ pour s√©parer les lignes (deux backslashes)
- Bien fermer avec \end{{pmatrix}}, \end{{bmatrix}}, \end{{vmatrix}}, ou \end{{cases}}

**EXEMPLES DE STRUCTURES CORRECTES:**

Exemple 1 - Analyse:
Exercice 1

Soit f la fonction d√©finie sur $\mathbb{{R}}$ par $f(x) = x^2 - 3x + 2$.

1. D√©terminer les racines de f et dresser le tableau de variations.
2. Calculer l'aire sous la courbe entre les deux racines:
\[A = \int_{{x_1}}^{{x_2}} f(x)\,dx\]
3. √âtudier la fonction compos√©e $g = f \circ f$.
   a) Montrer que g est paire.
   b) Calculer $g'(0)$.

Exemple 2 - Alg√®bre lin√©aire:
Exercice 2

Soit A la matrice d√©finie par:
\[A = \begin{{bmatrix}}
1 & 2 & -1 \\
0 & 3 & 2 \\
-1 & 1 & 4
\end{{bmatrix}}\]

1. Calculer le d√©terminant de A:
\[\det(A) = \begin{{vmatrix}}
1 & 2 & -1 \\
0 & 3 & 2 \\
-1 & 1 & 4
\end{{vmatrix}}\]
2. R√©soudre le syst√®me lin√©aire suivant:
\[\begin{{cases}}
x + 2y - z = 3 \\
3y + 2z = 5 \\
-x + y + 4z = 1
\end{{cases}}\]
3. D√©terminer les valeurs propres de A.

**VALIDATION FINALE:**
- Chaque question commence par "1. ", "2. ", "3. "
- Chaque sous-question commence par "a) ", "b) ", "c) "
- Toutes les formules sont entre $...$ ou \[...\]
- Aucun caract√®re markdown (*, **, #)
- Aucune commande LaTeX de mise en forme (\textbf, \textit, etc.)
- Le titre n'a PAS de contenu sur la m√™me ligne

---

**CRIT√àRE DE SUCC√àS :**
Un √©tudiant de niveau "{str(level_indication[1])}" ne doit PAS penser :
"c'est juste l'exercice original reformul√©",
mais plut√¥t :
"voici un nouvel exercice exigeant et intelligemment con√ßu".

Le LaTeX g√©n√©r√© doit compiler SANS AUCUNE ERREUR dans l'app mobile.

---

G√âN√àRE MAINTENANT L'EXERCICE (UNIQUEMENT L'√âNONC√â, AUCUNE SOLUTION).
"""
